<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <title>Message admin</title>
</head>
<body style="background:#111;color:#fff;font-family:Arial;padding:20px">

<h2>Envoyer un message</h2>

<form method="post">
  <label>Cible :</label><br>
  <select name="target" id="target" required>
    <option value="single" selected>Un joueur</option>
    <option value="all">Tous les joueurs</option>
    <option value="demons">Tous les démons</option>
  </select>

  <br><br>

  <div id="singlePlayerBlock">
    <label>Joueur :</label><br>
    <select name="joueur" id="joueur">
      {% for j in joueurs %}
        <option value="{{ j }}">Joueur {{ j }}</option>
      {% endfor %}
    </select>
    <br><br>
  </div>

  <label>Message :</label><br>
  <textarea name="message" rows="4" cols="40" required></textarea>

  <br><br>

  <button type="submit">Envoyer</button>
</form>

<br>
<a href="{{ url_for('admin_dashboard') }}">⬅ Retour</a>

<script>
  const target = document.getElementById('target');
  const singleBlock = document.getElementById('singlePlayerBlock');
  const joueurSelect = document.getElementById('joueur');

  function refresh() {
    const isSingle = (target.value === 'single');
    singleBlock.style.display = isSingle ? 'block' : 'none';
    joueurSelect.required = isSingle;
  }

  target.addEventListener('change', refresh);
  refresh();
</script>

</body>
</html>
