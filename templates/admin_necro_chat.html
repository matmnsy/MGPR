<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <title>Admin — Messages des morts</title>
  <style>
    body{
      margin:0;
      padding:20px;
      background:#111 url('/static/fond.png') center/cover no-repeat;
      font-family:Arial,sans-serif;
      color:#fff;
    }
    .wrap{
      max-width:900px;
      margin:0 auto;
      background:rgba(0,0,0,0.8);
      padding:20px;
      border-radius:14px;
    }
    h1{
      margin:0 0 6px 0;
      font-size:22px;
    }
    .subtitle{
      font-size:13px;
      color:#ccc;
      margin-bottom:10px;
    }
    .section-title{
      margin-top:10px;
      margin-bottom:4px;
      font-weight:bold;
    }
    .pill{
      display:inline-block;
      padding:4px 8px;
      border-radius:999px;
      background:rgba(255,255,255,0.08);
      font-size:13px;
      margin-right:6px;
      margin-bottom:4px;
    }
    table{
      width:100%;
      border-collapse:collapse;
      margin-top:8px;
      font-size:14px;
    }
    th,td{
      padding:8px;
      border-bottom:1px solid rgba(255,255,255,0.1);
      text-align:left;
      vertical-align:top;
    }
    .btn-reveal{
      padding:4px 8px;
      border-radius:999px;
      border:none;
      background:#ff77d9;
      color:#fff;
      font-size:12px;
      text-decoration:none;
      white-space:nowrap;
    }
    .badge-revealed{
      display:inline-block;
      padding:4px 8px;
      border-radius:999px;
      background:rgba(120, 255, 160, 0.3);
      font-size:12px;
    }
    .back{
      margin-top:12px;
      font-size:13px;
    }
    .back a{
      color:#fff;
      text-decoration:none;
      border-bottom:1px solid rgba(255,255,255,0.6);
    }
  </style>
</head>
<body>
<div class="wrap">
  <h1>Messages des morts</h1>
  <div class="subtitle">
    Vous voyez ici les dernières volontés écrites par les joueurs éliminés. Vous choisissez lesquelles sont révélées au Nécromancien.
  </div>

  <div class="section-title">Nécromancien</div>
  {% if necro_id %}
    <div class="pill">
      Joueur {{ necro_id }} — {{ roles[necro_id]['name'] }}
    </div>
  {% else %}
    <div style="font-size:13px;color:#ccc;">Aucun Nécromancien défini.</div>
  {% endif %}

  <div class="section-title">Messages des joueurs éliminés</div>
  {% if eliminated_players %}
    <table>
      <thead>
        <tr>
          <th>Joueur</th>
          <th>Rôle</th>
          <th>Message</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody>
        {% for j in eliminated_players %}
          {% set m = messages_by_author.get(j) %}
          <tr>
            <td>Joueur {{ j }}</td>
            <td>{{ roles[j]['name'] }}</td>
            <td>
              {% if m %}
                {{ m["text"] }}
              {% else %}
                <span style="color:#888;">Aucun message reçu</span>
              {% endif %}
            </td>
            <td>
              {% if m %}
                {% if m["revealed"] %}
                  <span class="badge-revealed">Révélé au Nécromancien</span>
                {% else %}
                  <a class="btn-reveal"
                     href="{{ url_for('admin_necro_reveal', msg_id=m['id']) }}">
                    Révéler
                  </a>
                {% endif %}
              {% else %}
                —
              {% endif %}
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <div style="font-size:13px;color:#ccc;">Aucun joueur éliminé.</div>
  {% endif %}

  <div class="back">
    <a href="{{ url_for('admin_dashboard') }}">Retour au dashboard</a>
  </div>
</div>
</body>
</html>
